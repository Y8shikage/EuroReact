{"ast":null,"code":"import React,{useState,useRef}from'react';import{useNavigate}from'react-router-dom';import{ReactComponent as DropFileIcon}from'../../assets/icons/DropFileIcon.svg';import{getRequirements}from'../../utils/videoValidator';import Folder from'../Folder';import'./VideoUpload.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function VideoUpload(_ref){let{onFileSelect,selectedFile,onCancel,onSubmit,isValid}=_ref;const navigate=useNavigate();const[isDragging,setIsDragging]=useState(false);const[error,setError]=useState('');const[folderKey,setFolderKey]=useState(0);const fileInputRef=useRef(null);const requirements=getRequirements();const handleFolderClick=()=>{navigate('/history');};// Обновляем ключ Folder при изменении selectedFile\nReact.useEffect(()=>{if(selectedFile){setFolderKey(prev=>prev+1);}},[selectedFile]);const handleDragOver=e=>{e.preventDefault();setIsDragging(true);};const handleDragLeave=e=>{e.preventDefault();setIsDragging(false);};const validateFile=file=>{setError('');// Проверка типа файла\nif(!file.type.startsWith('video/')){setError('Пожалуйста, выберите видео файл');return false;}// Проверка размера файла\nif(file.size>requirements.maxFileSize){setError(\"\\u0420\\u0430\\u0437\\u043C\\u0435\\u0440 \\u0444\\u0430\\u0439\\u043B\\u0430 \\u043F\\u0440\\u0435\\u0432\\u044B\\u0448\\u0430\\u0435\\u0442 \".concat(requirements.maxFileSizeMB,\" \\u041C\\u0411\"));return false;}return true;};const handleDrop=e=>{e.preventDefault();setIsDragging(false);const files=e.dataTransfer.files;if(files.length>0){const file=files[0];if(validateFile(file)){onFileSelect(file);}}};const handleFileInput=e=>{const files=e.target.files;if(files.length>0){const file=files[0];if(validateFile(file)){onFileSelect(file);}}};const handleClick=()=>{var _fileInputRef$current;(_fileInputRef$current=fileInputRef.current)===null||_fileInputRef$current===void 0?void 0:_fileInputRef$current.click();};const formatFileSize=bytes=>{if(bytes===0)return'0 Bytes';const k=1024;const sizes=['Bytes','KB','MB','GB'];const i=Math.floor(Math.log(bytes)/Math.log(k));return Math.round(bytes/Math.pow(k,i))+' '+sizes[i];};return/*#__PURE__*/_jsxs(\"div\",{className:\"video-upload-container\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"upload-title\",children:\"\\u0417\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C\"}),!selectedFile?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"drop-zone \".concat(isDragging?'dragging':'',\" \").concat(error?'error':''),onDragOver:handleDragOver,onDragLeave:handleDragLeave,onDrop:handleDrop,onClick:handleClick,children:[/*#__PURE__*/_jsx(DropFileIcon,{className:\"drop-icon\"}),/*#__PURE__*/_jsx(\"p\",{className:\"drop-text\",children:\"\\u041F\\u0435\\u0440\\u0435\\u0442\\u044F\\u043D\\u0438\\u0442\\u0435 \\u0432\\u0430\\u0448 \\u0444\\u0430\\u0439\\u043B \\u0438\\u043B\\u0438 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u0435 \\u0441 \\u0443\\u0441\\u0442\\u0440\\u043E\\u0439\\u0441\\u0442\\u0432\\u0430\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"drop-limit\",children:[\"\\u041C\\u0430\\u043A\\u0441\\u0438\\u043C\\u0430\\u043B\\u044C\\u043D\\u044B\\u0439 \\u0440\\u0430\\u0437\\u043C\\u0435\\u0440 \\u0444\\u0430\\u0439\\u043B\\u0430 \",requirements.maxFileSizeMB,\" \\u041C\\u0411\",/*#__PURE__*/_jsx(\"br\",{}),\"\\u0414\\u043B\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E\\u0441\\u0442\\u044C: \",requirements.allowedDurations.join(' или '),\" \\u0441\\u0435\\u043A\\u0443\\u043D\\u0434\"]}),/*#__PURE__*/_jsx(\"input\",{ref:fileInputRef,type:\"file\",accept:\"video/*\",onChange:handleFileInput,style:{display:'none'}})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"file-selected\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"file-info\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"file-icon-wrapper\",children:/*#__PURE__*/_jsx(DropFileIcon,{className:\"file-icon\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"file-details\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"file-name\",children:selectedFile.name}),/*#__PURE__*/_jsx(\"p\",{className:\"file-size\",children:formatFileSize(selectedFile.size)})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"action-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn-cancel\",onClick:onCancel,children:\"\\u041D\\u0430\\u0437\\u0430\\u0434\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-save \".concat(!isValid?'disabled':''),onClick:onSubmit,disabled:!isValid,children:\"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"folder-container\",children:/*#__PURE__*/_jsx(Folder,{size:1.5,color:\"#8a5cff\",onClick:handleFolderClick},folderKey)})]})]});}","map":{"version":3,"names":["React","useState","useRef","useNavigate","ReactComponent","DropFileIcon","getRequirements","Folder","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","VideoUpload","_ref","onFileSelect","selectedFile","onCancel","onSubmit","isValid","navigate","isDragging","setIsDragging","error","setError","folderKey","setFolderKey","fileInputRef","requirements","handleFolderClick","useEffect","prev","handleDragOver","e","preventDefault","handleDragLeave","validateFile","file","type","startsWith","size","maxFileSize","concat","maxFileSizeMB","handleDrop","files","dataTransfer","length","handleFileInput","target","handleClick","_fileInputRef$current","current","click","formatFileSize","bytes","k","sizes","i","Math","floor","log","round","pow","className","children","onDragOver","onDragLeave","onDrop","onClick","allowedDurations","join","ref","accept","onChange","style","display","name","disabled","color"],"sources":["C:/Users/F1toF/OneDrive/Desktop/cours/cours/cours-project/src/components/VideoUpload/VideoUpload.js"],"sourcesContent":["import React, { useState, useRef } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { ReactComponent as DropFileIcon } from '../../assets/icons/DropFileIcon.svg';\r\nimport { getRequirements } from '../../utils/videoValidator';\r\nimport Folder from '../Folder';\r\nimport './VideoUpload.css';\r\n\r\nexport default function VideoUpload({ onFileSelect, selectedFile, onCancel, onSubmit, isValid }) {\r\n  const navigate = useNavigate();\r\n  const [isDragging, setIsDragging] = useState(false);\r\n  const [error, setError] = useState('');\r\n  const [folderKey, setFolderKey] = useState(0);\r\n  const fileInputRef = useRef(null);\r\n  const requirements = getRequirements();\r\n\r\n  const handleFolderClick = () => {\r\n    navigate('/history');\r\n  };\r\n\r\n  // Обновляем ключ Folder при изменении selectedFile\r\n  React.useEffect(() => {\r\n    if (selectedFile) {\r\n      setFolderKey(prev => prev + 1);\r\n    }\r\n  }, [selectedFile]);\r\n\r\n  const handleDragOver = (e) => {\r\n    e.preventDefault();\r\n    setIsDragging(true);\r\n  };\r\n\r\n  const handleDragLeave = (e) => {\r\n    e.preventDefault();\r\n    setIsDragging(false);\r\n  };\r\n\r\n  const validateFile = (file) => {\r\n    setError('');\r\n    \r\n    // Проверка типа файла\r\n    if (!file.type.startsWith('video/')) {\r\n      setError('Пожалуйста, выберите видео файл');\r\n      return false;\r\n    }\r\n    \r\n    // Проверка размера файла\r\n    if (file.size > requirements.maxFileSize) {\r\n      setError(`Размер файла превышает ${requirements.maxFileSizeMB} МБ`);\r\n      return false;\r\n    }\r\n    \r\n    return true;\r\n  };\r\n\r\n  const handleDrop = (e) => {\r\n    e.preventDefault();\r\n    setIsDragging(false);\r\n    \r\n    const files = e.dataTransfer.files;\r\n    if (files.length > 0) {\r\n      const file = files[0];\r\n      if (validateFile(file)) {\r\n        onFileSelect(file);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleFileInput = (e) => {\r\n    const files = e.target.files;\r\n    if (files.length > 0) {\r\n      const file = files[0];\r\n      if (validateFile(file)) {\r\n        onFileSelect(file);\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleClick = () => {\r\n    fileInputRef.current?.click();\r\n  };\r\n\r\n  const formatFileSize = (bytes) => {\r\n    if (bytes === 0) return '0 Bytes';\r\n    const k = 1024;\r\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n    return Math.round(bytes / Math.pow(k, i)) + ' ' + sizes[i];\r\n  };\r\n\r\n  return (\r\n    <div className=\"video-upload-container\">\r\n      <h2 className=\"upload-title\">Загрузить</h2>\r\n      \r\n      {!selectedFile ? (\r\n        <>\r\n          <div\r\n            className={`drop-zone ${isDragging ? 'dragging' : ''} ${error ? 'error' : ''}`}\r\n            onDragOver={handleDragOver}\r\n            onDragLeave={handleDragLeave}\r\n            onDrop={handleDrop}\r\n            onClick={handleClick}\r\n          >\r\n            <DropFileIcon className=\"drop-icon\" />\r\n            <p className=\"drop-text\">Перетяните ваш файл или загрузите с устройства</p>\r\n            <p className=\"drop-limit\">\r\n              Максимальный размер файла {requirements.maxFileSizeMB} МБ\r\n              <br />\r\n              Длительность: {requirements.allowedDurations.join(' или ')} секунд\r\n            </p>\r\n            <input\r\n              ref={fileInputRef}\r\n              type=\"file\"\r\n              accept=\"video/*\"\r\n              onChange={handleFileInput}\r\n              style={{ display: 'none' }}\r\n            />\r\n          </div>\r\n          {error && <div className=\"error-message\">{error}</div>}\r\n        </>\r\n      ) : (\r\n        <div className=\"file-selected\">\r\n          <div className=\"file-info\">\r\n            <div className=\"file-icon-wrapper\">\r\n              <DropFileIcon className=\"file-icon\" />\r\n            </div>\r\n            <div className=\"file-details\">\r\n              <p className=\"file-name\">{selectedFile.name}</p>\r\n              <p className=\"file-size\">{formatFileSize(selectedFile.size)}</p>\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"action-buttons\">\r\n            <button className=\"btn-cancel\" onClick={onCancel}>\r\n              Назад\r\n            </button>\r\n            <button \r\n              className={`btn-save ${!isValid ? 'disabled' : ''}`}\r\n              onClick={onSubmit}\r\n              disabled={!isValid}\r\n            >\r\n              Отправить\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"folder-container\">\r\n            <Folder \r\n              key={folderKey}\r\n              size={1.5} \r\n              color=\"#8a5cff\" \r\n              onClick={handleFolderClick}\r\n            />\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}